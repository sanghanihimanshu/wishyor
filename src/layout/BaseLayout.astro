---
import Navbar from "@sections/Navbar.astro";
import Footer from "@sections/Footer.astro";
import { ClientRouter } from "astro:transitions";
import { SEO, type Props as SEOProps } from "astro-seo";
import { Schema } from "astro-seo-schema";
import type { WithContext, Thing } from "schema-dts";
import { AstroFont } from "astro-font";
import "@styles/global.css";

interface Props {
  seo?: SEOProps;
  schema?: WithContext<Thing>;
}

const { seo, schema } = Astro.props;
const site = Astro.site?.toString() || "https://www.wishyor.com";
const currentUrl = Astro.url.href;
const socialImage = `${site}/social.png`;

const defaultTitle = "Wishyor | Custom Software Development & Digital Transformation Services";
const defaultDescription = "Wishyor offers custom software, cloud, AI/ML, and digital transformation solutions. Elevate your business with expert tech consulting.";

const organizationSchema: WithContext<Thing> = {
  "@context": "https://schema.org",
  "@type": "Organization",
  "@id": site,
  url: site,
  name: "Wishyor",
  legalName: "Wishyor Technologies",
  description: "Custom software development and digital transformation services company specializing in cloud solutions, AI/ML integration, and enterprise technology consulting.",
  foundingDate: "2020",
  serviceArea: {
    "@type": "Place",
    name: "Worldwide"
  },
  areaServed: "Worldwide",
  hasOfferCatalog: {
    "@type": "OfferCatalog",
    name: "Technology Services",
    itemListElement: [
      {
        "@type": "Offer",
        itemOffered: {
          "@type": "Service",
          name: "Custom Software Development",
          description: "Tailored software solutions for businesses"
        }
      },
      {
        "@type": "Offer",
        itemOffered: {
          "@type": "Service",
          name: "Cloud Solutions",
          description: "Cloud infrastructure and migration services"
        }
      },
      {
        "@type": "Offer",
        itemOffered: {
          "@type": "Service",
          name: "AI/ML Integration",
          description: "Artificial intelligence and machine learning implementation"
        }
      },
      {
        "@type": "Offer",
        itemOffered: {
          "@type": "Service",
          name: "Digital Transformation",
          description: "Complete digital transformation consulting"
        }
      }
    ]
  },
  contactPoint: {
    "@type": "ContactPoint",
    contactType: "customer service",
    availableLanguage: "English"
  },
  sameAs: [
    "https://linkedin.com/company/wishyor",
    "https://twitter.com/wishyor"
  ],
  mainEntityOfPage: {
    "@type": "WebPage",
    "@id": currentUrl,
    url: currentUrl,
    name: seo?.title || defaultTitle,
    description: seo?.description || defaultDescription,
    inLanguage: "en-US",
    isPartOf: {
      "@type": "WebSite",
      "@id": `${site}#website`,
      url: site,
      name: "Wishyor",
      description: "Professional technology services and custom software development solutions."
    },
    publisher: {
      "@type": "Organization",
      name: "Wishyor Technologies",
      logo: {
        "@type": "ImageObject",
        url: `${site}/logo.png`
      }
    }
  }
};

const websiteSchema: WithContext<Thing> = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "@id": `${site}#website`,
  url: site,
  name: "Wishyor",
  potentialAction: {
    "@type": "SearchAction",
    target: `${site}/search?q={search_term_string}`,
  }
};
---

<html lang="en">
  <head>
    <SEO
      charset="utf-8"
      title={seo?.title || defaultTitle}
      description={seo?.description || defaultDescription}
      canonical={currentUrl}
      openGraph={{
        basic: {
          title: seo?.title || defaultTitle,
          type: "website",
          image: socialImage,
          url: currentUrl,
        },
        optional: {
          description: seo?.description || defaultDescription,
          siteName: "Wishyor",
          locale: "en_US",
        },
      }}
      twitter={{
        card: "summary_large_image",
        title: seo?.title || defaultTitle,
        description: seo?.description || defaultDescription,
        image: socialImage,
        imageAlt: "Wishyor - Enterprise Technology Solutions",
        site: "@wishyor",
      }}
      extend={{
        link: [
          { rel: "icon", href: "/favicon.ico", sizes: "any" },
          { rel: "icon", href: "/icon.svg", type: "image/svg+xml" },
          { rel: "apple-touch-icon", href: "/apple-touch-icon.png" },
          { rel: "manifest", href: "/manifest.webmanifest" },
        ],
        meta: [
          { name: "viewport", content: "width=device-width, initial-scale=1" },
          { name: "generator", content: Astro.generator },
          { name: "robots", content: "index, follow, max-snippet:-1, max-image-preview:large" },
          { name: "author", content: "Wishyor Technologies" },
          { name: "theme-color", content: "#0f766e" },
          { name: "apple-mobile-web-app-title", content: "Wishyor" },
          { name: "apple-mobile-web-app-capable", content: "yes" },
          { name: "apple-mobile-web-app-status-bar-style", content: "default" },
          { name: "keywords", content: "custom software development, cloud solutions, AI integration, ML integration, digital transformation, tech consulting, software engineering, agile development, cloud computing, AWS experts, Azure solutions, Google Cloud services, DevOps, CI/CD, cloud migration, enterprise software, web app development, mobile app development, full-stack development, artificial intelligence, machine learning, predictive analytics, automation solutions, NLP, computer vision, IT modernization, legacy system upgrade, business process automation, data-driven solutions, scalable IT services, next-gen technology, digital innovation, emerging tech trends, software as a service, SaaS development, future-ready tech, technology partner, smart enterprise solutions" },
          { name: "business:contact_data:street_address", content: "SG Highway" },
          { name: "business:contact_data:locality", content: "Ahmedabad" },
          { name: "business:contact_data:region", content: "Gujarat" },
          { name: "business:contact_data:postal_code", content: "380015" },
          { name: "business:contact_data:country_name", content: "India" },
          { name: "category", content: "Technology Services" },
          { name: "coverage", content: "Worldwide" },
          { name: "distribution", content: "Global" },
          { name: "rating", content: "General" },
          { name: "target", content: "all" },
          { name: "HandheldFriendly", content: "True" },
          { name: "MobileOptimized", content: "320" },
          { name: "geo.region", content: "IN-GJ" },
          { name: "geo.placename", content: "Ahmedabad" },
          { name: "ICBM", content: "23.0225, 72.5714" },
          { name: "google-site-verification", content: "your-google-site-verification-code" },
          { name: "publisher", content: "Wishyor" },
          { name: "application-name", content: "Wishyor" },
          { name: "msapplication-TileColor", content: "#0f766e" },
          { name: "msapplication-TileImage", content: "/mstile-150x150.png" },
          { name: "msapplication-config", content: "/browserconfig.xml" },
          { name: "theme-color", content: "#0f766e" },
        ],
      }}
    />

    <Schema item={schema || organizationSchema} />
    <Schema item={websiteSchema} />
    <ClientRouter />

    <AstroFont
      config={[
        {
          src: [],
          name: "DM Sans",
          googleFontsURL: "https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,400;500;600;700&display=swap",
          preload: true,
          display: "swap",
          selector: "h1, h2, h3, h4",
          fallback: "sans-serif",
        },
        {
          src: [],
          name: "Work Sans",
          googleFontsURL: "https://fonts.googleapis.com/css2?family=Work+Sans:wght@300;400;500;600&display=swap",
          preload: true,
          display: "swap",
          selector: "body",
          fallback: "sans-serif",
        },
      ]}
    />

    <script>
      import type { TransitionBeforeSwapEvent } from "astro:transitions/client";
      document.addEventListener("astro:before-swap", (e) =>
        [...(e as TransitionBeforeSwapEvent).newDocument.head.querySelectorAll('link[as="font"]')]
          .forEach((link) => link.remove())
      );
    </script>
<link rel="sitemap" href="/sitemap-index.xml" />
  </head>
  <body class="bg-off-white selection:bg-teal-400 selection:text-slate-700">
    <Navbar />
    <main>
      <slot />
    </main>
    <Footer />
  </body>
</html>
